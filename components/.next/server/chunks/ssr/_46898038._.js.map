{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gabriel%20Dias/Desktop/offers-main/controllers/authController.js"],"sourcesContent":["\"use server\";\n\nimport { db } from \"@/lib/db\";\nimport { z } from \"zod\";\nimport { hash } from \"bcryptjs\";\nimport { signIn, signOut } from \"@/auth\";\nimport { isRedirectError } from \"next/dist/client/components/redirect-error\";\n\nconst schema = z\n  .object({\n    name: z.string().min(3, \"Nome deve possui no mínimo 3 letras\"),\n    email: z.string().email(\"E-mail inválido\"),\n    phone: z\n      .string()\n      .min(10, \"Número de telefone inválido\")\n      .max(11, \"Número de telefone inválido\"),\n    password: z.string(),\n    confirmPassword: z.string().min(1, \"Confirme sua senha\"),\n  })\n  .refine((data) => data.password === data.confirmPassword, {\n    path: [\"confirmPassword\"],\n    message: \"As senhas não coicidem\",\n  });\n\nexport async function register(_prevState, formData) {\n  const entries = Array.from(formData.entries());\n  const data = Object.fromEntries(entries);\n\n  const result = schema.safeParse(data);\n\n  if (!result.success) {\n    return {\n      success: false,\n      errors: result.error.flatten().fieldErrors,\n    };\n  }\n\n  const existingEmail = await db.user.findUnique({\n    where: {\n      email: data.email,\n    },\n  });\n\n  const existingPhone = await db.user.findUnique({\n    where: {\n      phone: data.phone,\n    },\n  });\n\n  if (existingEmail) {\n    return {\n      success: false,\n      errors: { email: \"Esse e-mail já está cadastrado\" },\n    };\n  }\n\n  if (existingPhone) {\n    return {\n      success: false,\n      errors: { phone: \"Esse telefone já está cadastrado\" },\n    };\n  }\n\n  const hashedPassword = await hash(data.password, 10);\n\n  await db.user.create({\n    data: {\n      name: data.name,\n      email: data.email,\n      phone: data.phone,\n      password: hashedPassword,\n    },\n  });\n\n  // await signIn(\"credentials\", {\n  //   email: formData.get(\"email\"),\n  //   password: formData.get(\"password\"),\n  //   redirect: true,\n  //   redirectTo: \"/\",\n  // });\n}\n\nexport async function login(_prevState, formData) {\n  try {\n    // const teste = formData.get(\"email\")\n    // console.log(teste)\n    await signIn(\"credentials\", {\n      email: formData.get(\"email\"),\n      password: formData.get(\"password\"),\n      redirect: true,\n      redirectTo: \"/\",\n    });\n\n    return {\n      success: false,\n      error: \"E-mail ou senha incorretos\",\n    };\n  } catch (error) {\n    // Correção do erro nativo do auth.js (está em beta)\n    if (isRedirectError(error)) {\n      throw error;\n    }\n\n    if (error.type === \"CredentialsSignin\") {\n      return {\n        success: false,\n        error: \"E-mail e/ou senha incorretos\",\n      };\n    }\n  }\n}\n\nexport async function logout() {\n  await signOut({ redirectTo: \"/\" });\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;AAEA,MAAM,SAAS,oIAAA,CAAA,IAAC,CACb,MAAM,CAAC;IACN,MAAM,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,OAAO,oIAAA,CAAA,IAAC,CACL,MAAM,GACN,GAAG,CAAC,IAAI,+BACR,GAAG,CAAC,IAAI;IACX,UAAU,oIAAA,CAAA,IAAC,CAAC,MAAM;IAClB,iBAAiB,oIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AACrC,GACC,MAAM,CAAC,CAAC,OAAS,KAAK,QAAQ,KAAK,KAAK,eAAe,EAAE;IACxD,MAAM;QAAC;KAAkB;IACzB,SAAS;AACX;AAEK,eAAe,uCAAM,GAAN,SAAS,UAAU,EAAE,QAAQ;IACjD,MAAM,UAAU,MAAM,IAAI,CAAC,SAAS,OAAO;IAC3C,MAAM,OAAO,OAAO,WAAW,CAAC;IAEhC,MAAM,SAAS,OAAO,SAAS,CAAC;IAEhC,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,OAAO;YACL,SAAS;YACT,QAAQ,OAAO,KAAK,CAAC,OAAO,GAAG,WAAW;QAC5C;IACF;IAEA,MAAM,gBAAgB,MAAM,yGAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QAC7C,OAAO;YACL,OAAO,KAAK,KAAK;QACnB;IACF;IAEA,MAAM,gBAAgB,MAAM,yGAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QAC7C,OAAO;YACL,OAAO,KAAK,KAAK;QACnB;IACF;IAEA,IAAI,eAAe;QACjB,OAAO;YACL,SAAS;YACT,QAAQ;gBAAE,OAAO;YAAiC;QACpD;IACF;IAEA,IAAI,eAAe;QACjB,OAAO;YACL,SAAS;YACT,QAAQ;gBAAE,OAAO;YAAmC;QACtD;IACF;IAEA,MAAM,iBAAiB,MAAM,CAAA,GAAA,iIAAA,CAAA,OAAI,AAAD,EAAE,KAAK,QAAQ,EAAE;IAEjD,MAAM,yGAAA,CAAA,KAAE,CAAC,IAAI,CAAC,MAAM,CAAC;QACnB,MAAM;YACJ,MAAM,KAAK,IAAI;YACf,OAAO,KAAK,KAAK;YACjB,OAAO,KAAK,KAAK;YACjB,UAAU;QACZ;IACF;AAEA,gCAAgC;AAChC,kCAAkC;AAClC,wCAAwC;AACxC,oBAAoB;AACpB,qBAAqB;AACrB,MAAM;AACR;AAEO,eAAe,uCAAG,GAAH,MAAM,UAAU,EAAE,QAAQ;IAC9C,IAAI;QACF,sCAAsC;QACtC,qBAAqB;QACrB,MAAM,CAAA,GAAA,oGAAA,CAAA,SAAM,AAAD,EAAE,eAAe;YAC1B,OAAO,SAAS,GAAG,CAAC;YACpB,UAAU,SAAS,GAAG,CAAC;YACvB,UAAU;YACV,YAAY;QACd;QAEA,OAAO;YACL,SAAS;YACT,OAAO;QACT;IACF,EAAE,OAAO,OAAO;QACd,oDAAoD;QACpD,IAAI,CAAA,GAAA,yKAAA,CAAA,kBAAe,AAAD,EAAE,QAAQ;YAC1B,MAAM;QACR;QAEA,IAAI,MAAM,IAAI,KAAK,qBAAqB;YACtC,OAAO;gBACL,SAAS;gBACT,OAAO;YACT;QACF;IACF;AACF;AAEO,eAAe,uCAAI,GAAJ;IACpB,MAAM,CAAA,GAAA,oGAAA,CAAA,UAAO,AAAD,EAAE;QAAE,YAAY;IAAI;AAClC;;;IA1FsB;IA0DA;IA8BA;;AAxFA,+OAAA;AA0DA,+OAAA;AA8BA,+OAAA","debugId":null}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gabriel%20Dias/Desktop/offers-main/lib/auth.js"],"sourcesContent":["import { auth } from \"@/auth\";\n\nexport async function currentUser() {\n  const session = await auth();\n\n  return session?.user;\n}\n"],"names":[],"mappings":";;;AAAA;;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM,CAAA,GAAA,oGAAA,CAAA,OAAI,AAAD;IAEzB,OAAO,SAAS;AAClB","debugId":null}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gabriel%20Dias/Desktop/offers-main/app/%28dashboard%29/my-account/actions.jsx"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from \"@/lib/db\";\r\nimport { currentUser } from \"@/lib/auth\";\r\nimport { signOut } from \"@/auth\";\r\n\r\nexport async function deleteAccount() {\r\n  const user = await currentUser();\r\n\r\n  if (!user || !user.id) {\r\n    throw new Error(\"Usuário não autenticado\");\r\n  }\r\n\r\n  await db.user.delete({\r\n    where: { id: user.id },\r\n  });\r\n\r\n  // Faz logout automático após deletar\r\n  await signOut({ redirectTo: \"/\" });\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;;;;;AAEO,eAAe,uCAAW,GAAX;IACpB,MAAM,OAAO,MAAM,CAAA,GAAA,2GAAA,CAAA,cAAW,AAAD;IAE7B,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,EAAE;QACrB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,yGAAA,CAAA,KAAE,CAAC,IAAI,CAAC,MAAM,CAAC;QACnB,OAAO;YAAE,IAAI,KAAK,EAAE;QAAC;IACvB;IAEA,qCAAqC;IACrC,MAAM,CAAA,GAAA,oGAAA,CAAA,UAAO,AAAD,EAAE;QAAE,YAAY;IAAI;AAClC;;;IAbsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 193, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 282, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gabriel%20Dias/Desktop/offers-main/app/%28dashboard%29/my-account/update-form.jsx"],"sourcesContent":["// import { useCurrentUser } from \"@/hooks/use-current-user\";\nimport { currentUser } from \"@/lib/auth\";\nimport UserInfo from \"./user-info\";\n\nexport default async function UpdateForm() {\n  // const user = useCurrentUser();\n  const user = await currentUser();\n\n  return <UserInfo label=\"Minha conta\" user={user} />;\n}\n"],"names":[],"mappings":"AAAA,6DAA6D;;;;;AAC7D;AACA;;;;AAEe,eAAe;IAC5B,iCAAiC;IACjC,MAAM,OAAO,MAAM,CAAA,GAAA,2GAAA,CAAA,cAAW,AAAD;IAE7B,qBAAO,8OAAC,sJAAA,CAAA,UAAQ;QAAC,OAAM;QAAc,MAAM;;;;;;AAC7C","debugId":null}},
    {"offset": {"line": 310, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gabriel%20Dias/Desktop/offers-main/app/%28dashboard%29/my-account/delete-account-form.jsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(dashboard)/my-account/delete-account-form.jsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(dashboard)/my-account/delete-account-form.jsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAsT,GACnV,oFACA","debugId":null}},
    {"offset": {"line": 324, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gabriel%20Dias/Desktop/offers-main/app/%28dashboard%29/my-account/delete-account-form.jsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(dashboard)/my-account/delete-account-form.jsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(dashboard)/my-account/delete-account-form.jsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAkS,GAC/T,gEACA","debugId":null}},
    {"offset": {"line": 338, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 348, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Gabriel%20Dias/Desktop/offers-main/app/%28dashboard%29/my-account/page.jsx"],"sourcesContent":["import UpdateForm from \"./update-form\";\nimport DeleteAccountForm from \"./delete-account-form\";\n\nexport default function MyAccount() {\n  return (\n    <div className=\"w-[560px]\">\n      <h2 className=\"m-6 text-3xl\">Minha conta</h2>\n\n      <UpdateForm />\n      <DeleteAccountForm />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAEe,SAAS;IACtB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAAe;;;;;;0BAE7B,8OAAC,wJAAA,CAAA,UAAU;;;;;0BACX,8OAAC,mKAAA,CAAA,UAAiB;;;;;;;;;;;AAGxB","debugId":null}}]
}